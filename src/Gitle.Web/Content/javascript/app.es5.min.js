"use strict";function Application(){}$.ajaxUploadSettings.name="uploads";$.fn.extend({insert:function(n){return this.each(function(){var t=$(this);t[0].nodeName==="TEXTAREA"&&t.val(t.val().substr(0,t.prop("selectionStart"))+n+t.val().substr(t.prop("selectionEnd")))})},error:function(n){return this.each(function(){$(this).siblings("small.error").remove();$(this).after('<small class="error">'+n+"<\/small>").parent().addClass("error")})},commafy:function(){return this.replace(".",",")},dotify:function(){return this.replace(",",".")},upload:function(){return this.each(function(){var n=$(this),t=$('<div class="progress">').append($('<span class="meter">')).insertAfter(this).hide(),r,i;$.browser.msie||n.after($('<small class="info">Je kunt ook afbeeldingen (jpg, png, gif) en bestanden (doc, docx, xls, xlsx, pdf, txt) uploaden door ze op het textveld te slepen.<\/small>'));r=$('<a href="#" class="button no-margin tiny">Upload afbeelding/bestand<\/a>').insertBefore(this);i={url:"/upload/file",beforeSend:function(){t.show()},onprogress:function(n){if(n.lengthComputable){console.log("Progress "+n.loaded+" of "+n.total);var i=n.loaded/n.total*100;t.find(".meter").css("width",i+"%")}},error:function(){console.log("error");n.error("Bestand(en) uploaden niet gelukt")},success:function(i){var u,r;i=$.parseJSON(i);for(u in i.Uploads)n.insert(i.Uploads[u]);for(r in i.Errors)console.log("Error: "+r+" - "+i.Errors[r]),n.error(r+": "+i.Errors[r]);t.hide()}};$(this).ajaxUploadDrop(i);r.ajaxUploadPrompt(i)})},uploadList:function(){return this.each(function(){var n=$(this),u=$($(this).data("template-container")),f=$($(this).data("template")),e=$(this).data("url"),t=$('<div class="progress">').append($('<span class="meter">')).insertAfter(this).hide(),r,i;$.browser.msie||n.after($('<small class="info">Je kunt ook afbeeldingen (jpg, png, gif) en bestanden (doc, docx, xls, xlsx, pdf, txt) uploaden door ze op de tabel te slepen.<\/small>'));r=$('<a href="#" class="button no-margin tiny">Upload document<\/a>').insertBefore(this);i={url:e,beforeSend:function(){t.show()},onprogress:function(n){if(n.lengthComputable){console.log("Progress "+n.loaded+" of "+n.total);var i=n.loaded/n.total*100;t.find(".meter").css("width",i+"%")}},error:function(){console.log("error");n.error("Bestand(en) uploaden niet gelukt")},success:function(i){var s,e,r,o;i=$.parseJSON(i);for(s in i.Uploads)e=i.Uploads[s],r=f.html(),r=r.replace(/{{id}}/g,e.Id),r=r.replace(/{{name}}/g,e.Name),r=r.replace(/{{path}}/g,e.Path),r=r.replace(/{{date}}/g,e.DateString),r=r.replace(/{{uploader}}/g,e.UserFullName),u.append(r);for(o in i.Errors)console.log("Error: "+o+" - "+i.Errors[o]),n.error(o+": "+i.Errors[o]);t.hide()}};$(this).ajaxUploadDrop(i);r.ajaxUploadPrompt(i)})}});Application.prototype={queryString:{},foundationSize:"",init:function(){for(var n=this,t,u=/\+/g,f=/([^&=]+)=?([^&]*)/g,i=function(n){return decodeURIComponent(n.replace(u," "))},e=window.location.search.substring(1),r;t=f.exec(e);)n.queryString[i(t[1])]=i(t[2]);$(document.body).addClass("js-enabled");r=new FoundationHelper;r.registerSizeClassChangeListener(onSizeClassChange=function(t){n.foundationSize=t;console.log("changed size class: "+t)});$(window).resize(function(){n.windowResize()}).resize();$("#search").autocomplete({serviceUrl:"/search",autoSelectFirst:!0,onSelect:function(n){window.location=n.data}});$(document).keydown(function(n){n.which==70&&n.ctrlKey&&n.shiftKey&&$("#search").focus()});$('form .focus[value=""]').focus();$("table.row-clickable tr").click(function(){var n=$(this).find("a").first().attr("href");n&&(window.location=n)});$("#initiate-joyride").click(function(){$(document).foundation("joyride","start")});$(".tablesorter").tablesorter({sortList:[[0,0]]});$(".chosen-select").chosen({no_results_text:"Oops, nothing found!",width:"100%"});$("input[data-remember]").each(function(){var t=$(this).data("remember");$.cookie(t)&&n.queryString.query==undefined&&$(this).val($.cookie(t)).parents("form").submit();$.cookie(t,$(this).val())}).change(function(){var n=$(this).data("remember");$.cookie(n,$(this).val())});n.initFreckleSelect();n.initCtrlS();n.initComments();slugify("#item_Name","#item_Slug");$(".uploadarea").upload();$(".uploadlist").uploadList();$(".colorpicker").colorPicker();$("table.nested").nestedTable({afterAdd:function(n){n.find(".colorpicker-open").prop("rel",n.find(".colorpicker").prop("name"));n.find(".colorpicker").colorPicker()}});marked.setOptions({breaks:!0});$(".marked").each(function(){$(this).html(marked($(this).html()))})},initComments:function(){$(".comments-container").each(function(){var n=$(this),i=n.find(".comments"),t=n.find("textarea");i.click(function(){n.addClass("edit");t.focus()});t.blur(function(){$.ajax({url:n.data("url"),method:"POST",dataType:"text",data:{comment:t.val()},success:function(t){i.html(marked(t));n.removeClass("edit")},error:function(){console.log("niet opgeslagen")}})})})},windowResize:function(){$(window).height()<$(document).height()?$(document.body).addClass("scroll"):$(document.body).removeClass("scroll")},initOnLoad:function(){},initCtrlS:function(){$(document).keydown(function(n){return(n.which==83&&n.ctrlKey)?($("form").submit(),n.preventDefault(),!1):!0})},initFreckleSelect:function(){$("#item_FreckleId").change(function(){$(this).val()!="0"?$("#item_FreckleName").val($(this).find("option:selected").html()):$("#item_FreckleName").val("")}).change()}};var app=null;$(document).ready(function(){app=new Application;app.init()});$(window).load(function(){app.initOnLoad()});