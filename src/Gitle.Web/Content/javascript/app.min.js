function Application(){}var growl,slugify,app;$.ajaxUploadSettings.name="uploads";$.fn.extend({insert:function(n){return this.each(function(){var t=$(this);t[0].nodeName=="TEXTAREA"&&t.val(t.val().substr(0,t.prop("selectionStart"))+n+t.val().substr(t.prop("selectionEnd")))})},error:function(n){return this.each(function(){$(this).siblings("small.error").remove();$(this).after('<small class="error">'+n+"<\/small>").parent().addClass("error")})},upload:function(){return this.each(function(){var n=$(this),t=$('<div class="progress">').append($('<span class="meter">')).insertAfter(this).hide(),r,i;$.browser.msie||n.after($('<small class="info">Je kunt ook afbeeldingen (jpg, png, gif) en bestanden (doc, docx, xls, xlsx, pdf, txt) uploaden door ze op het textveld te slepen.<\/small>'));r=$('<a href="#" class="button no-margin tiny">Upload afbeelding/bestand<\/a>').insertBefore(this);i={url:"/upload/file",beforeSend:function(){t.show()},onprogress:function(n){if(n.lengthComputable){console.log("Progress "+n.loaded+" of "+n.total);var i=n.loaded/n.total*100;t.find(".meter").css("width",i+"%")}},error:function(){console.log("error");n.error("Bestand(en) uploaden niet gelukt")},success:function(i){var u,r;i=$.parseJSON(i);for(u in i.Uploads)n.insert(i.Uploads[u]);for(r in i.Errors)console.log("Error: "+r+" - "+i.Errors[r]),n.error(r+": "+i.Errors[r]);t.hide()}};$(this).ajaxUploadDrop(i);r.ajaxUploadPrompt(i)})},uploadList:function(){return this.each(function(){var n=$(this),u=$($(this).data("template-container")),f=$($(this).data("template")),e=$(this).data("url"),t=$('<div class="progress">').append($('<span class="meter">')).insertAfter(this).hide(),r,i;$.browser.msie||n.after($('<small class="info">Je kunt ook afbeeldingen (jpg, png, gif) en bestanden (doc, docx, xls, xlsx, pdf, txt) uploaden door ze op de tabel te slepen.<\/small>'));r=$('<a href="#" class="button no-margin tiny">Upload document<\/a>').insertBefore(this);i={url:e,beforeSend:function(){t.show()},onprogress:function(n){if(n.lengthComputable){console.log("Progress "+n.loaded+" of "+n.total);var i=n.loaded/n.total*100;t.find(".meter").css("width",i+"%")}},error:function(){console.log("error");n.error("Bestand(en) uploaden niet gelukt")},success:function(i){var s,e,r,o;i=$.parseJSON(i);for(s in i.Uploads)e=i.Uploads[s],r=f.html(),r=r.replace(/{{id}}/g,e.Id),r=r.replace(/{{name}}/g,e.Name),r=r.replace(/{{path}}/g,e.Path),r=r.replace(/{{date}}/g,e.DateString),r=r.replace(/{{uploader}}/g,e.UserFullName),u.append(r);for(o in i.Errors)console.log("Error: "+o+" - "+i.Errors[o]),n.error(o+": "+i.Errors[o]);t.hide()}};$(this).ajaxUploadDrop(i);r.ajaxUploadPrompt(i)})}});$.fn.nestedTable=function(n){var t=jQuery.extend({deleteText:"Verwijder",afterAdd:function(){}},n),i=function(n){n.preventDefault();$(this).parents("tr").remove()};return this.each(function(){var n=$(this),e=$("<th>"+t.deleteText+"<\/th>"),r,f,u;n.find("thead tr").append(e);r=$('<a href="#" class="button tiny no-margin alert">Verwijder<\/a>');r.click(i);f=$("<td><\/td>").append(r);n.find("tbody tr").append(f);u=$('<a href="#" class="button small">Nieuw<\/a>');u.click(function(r){r.preventDefault();var f=n.find("tbody tr:last-child input:first-child"),e=parseInt(f.length==0?0:f.prop("name").match(/\d+/)[0])+1,o=n.find("tbody tr:first-child"),u=o.clone().removeClass("hide");u.find(":input").each(function(){var n=$(this),t=n.prop("name"),i=t.replace(/\d+/g,e);n.attr("name",i)});u.find("[type=text]").val("");u.find("[data-nested-remove]").remove();u.find("[type=checkbox]").removeProp("checked");u.find(".button.alert").click(i);n.find("tbody").append(u);t.afterAdd(u)});n.after(u)})};growl=function(n,t){var i=$("<div>").addClass("alert-box");$("body").prepend(i.addClass(n).html(t));i.delay(2e3).fadeOut(2e3,function(){$(this).remove()})};slugify=function(n,t){$(n).change(function(){$.ajax({method:"POST",data:{text:$(this).val()},url:"/slug/index",success:function(n){$(t).val(n)}})}).change()};Application.prototype={queryString:{},init:function(){for(var n=this,t,u=/\+/g,f=/([^&=]+)=?([^&]*)/g,r=function(n){return decodeURIComponent(n.replace(u," "))},e=window.location.search.substring(1),i;t=f.exec(e);)n.queryString[r(t[1])]=r(t[2]);$(document.body).addClass("js-enabled");$(window).resize(function(){n.windowResize()}).resize();$("#search").autocomplete({serviceUrl:"/search",autoSelectFirst:!0,onSelect:function(n){window.location=n.data}});$(document).keydown(function(n){n.which==70&&n.ctrlKey&&n.shiftKey&&$("#search").focus()});$("form .focus[value=]").focus();$("table.row-clickable tr").click(function(){var n=$(this).find("a").first().attr("href");n&&(window.location=n)});$("#initiate-joyride").click(function(){$(document).foundation("joyride","start")});$(".tablesorter").tablesorter({sortList:[[0,0]]});$(".chosen-select").chosen({no_results_text:"Oops, nothing found!",width:"100%"});$(".time-parser").blur(function(){var n=$(this).val(),t;n!==""&&n!=="0"&&(n=n.replace(/[A-Za-z$-]/g,""),n=n.replace(",","."),n=parseFloat(n),t=n<.25,t&&(n=.25),n=n.toString().replace(".",","),$(this).val(n),t&&$(this).error("minimum is een kwartier"))});n.initFreckleSelect();n.initCtrlS();n.initComments();slugify("#item_Name","#item_Slug");$(".uploadarea").upload();$(".uploadlist").uploadList();$(".colorpicker").colorPicker();$("table.nested").nestedTable({afterAdd:function(n){n.find(".colorpicker-open").prop("rel",n.find(".colorpicker").prop("name"));n.find(".colorpicker").colorPicker()}});$(".three-state-checker").each(function(){var t=$(this),i,n;t.append('<i class="fa fa-square-o none"><\/i><i class="fa fa-check-square-o all"><\/i><i class="fa fa-minus-square-o some"><\/i>');i=$(this).data("selector");n=$(i);n.click(function(){n.length==n.filter(":checked").length?t.attr("data-state","all"):n.filter(":checked").length==0?t.attr("data-state","none"):t.attr("data-state","some")})}).click(function(){var t=$(this).data("selector"),i=$(this).attr("data-state"),n=$(t);switch(i){case"none":n.attr("checked","checked");$(this).attr("data-state","all");break;default:n.removeAttr("checked");$(this).attr("data-state","none")}n.change()});$("input[data-remember]").each(function(){var t=$(this).data("remember");$.cookie(t)&&n.queryString.query==undefined&&$(this).val($.cookie(t)).parents("form").submit();$.cookie(t,$(this).val())}).change(function(){var n=$(this).data("remember");$.cookie(n,$(this).val())});$("#group-actions").hide();$(".issues input[type=checkbox][name=issue]").change(function(){var t=$(".issues input[type=checkbox][name=issue]:checked"),n;t.length>0?$("#group-actions, #exportselection").show():$("#group-actions, #exportselection").hide();n=[];t.each(function(){n.push($(this).val())});$("#group-actions [name=issues]").val(n.join(","))}).change();$("[data-group-action]").click(function(n){n.preventDefault();var i=$("#group-actions input[name=issues]").val(),t=$(this).prop("href");location.href=t+(t.indexOf("?")==-1?"?":"&")+"issues="+i});$(".issue").click(function(){var n=$(this).find("input[type=checkbox]");n.prop("checked",!n.is(":checked")).change()}).on("click","a, input",function(n){n.stopPropagation()});marked.setOptions({breaks:!0});$(".marked").each(function(){$(this).html(marked($(this).html()))});i=800;$("[data-quickview]").hover(function(){var n=$(this),r,t;$(this).data("tooltip")==undefined?(r=$(this).position(),t=$('<div class="quickview">').css("top",r.top+$(this).height()).css("left",r.left),$(this).data("tooltip",t),t.load($(this).data("quickview"),function(){t.find(".marked").each(function(){$(this).html(marked($(this).html()))});n.append(t.hide());n.data("timeout",setTimeout(function(){n.is(":hover")&&n.data("tooltip").show()},i))})):n.data("timeout",setTimeout(function(){n.is(":hover")&&n.data("tooltip").show()},i))},function(){$(".quickview").hide()})},initComments:function(){$(".comments-container").each(function(){var n=$(this),i=n.find(".comments"),t=n.find("textarea");i.click(function(){n.addClass("edit");t.focus()});t.blur(function(){$.ajax({url:n.data("url"),method:"POST",dataType:"text",data:{comment:t.val()},success:function(t){i.html(marked(t));n.removeClass("edit")},error:function(){console.log("niet opgeslagen")}})})})},windowResize:function(){$(window).height()<$(document).height()?$(document.body).addClass("scroll"):$(document.body).removeClass("scroll")},initOnLoad:function(){},initCtrlS:function(){$(document).keydown(function(n){return(n.which==83&&n.ctrlKey)?($("form").submit(),n.preventDefault(),!1):!0})},initFreckleSelect:function(){$("#item_FreckleId").change(function(){$(this).val()!="0"?$("#item_FreckleName").val($(this).find("option:selected").html()):$("#item_FreckleName").val("")}).change()}};app=null;$(document).ready(function(){app=new Application;app.init()});$(window).load(function(){app.initOnLoad()});